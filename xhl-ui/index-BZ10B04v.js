import{ElOption as e,ElSelect as n,ElIcon as t,ElInput as a,ElTooltip as l,ElTree as o,ElConfigProvider as d}from"element-plus/es";import{toRefs as r,computed as s,ref as i,watch as c,onMounted as u,onUpdated as h,nextTick as p,openBlock as f,createBlock as m,unref as v,withCtx as x,createVNode as g,createElementBlock as k,Fragment as y,renderList as _,createCommentVNode as w,createElementVNode as b,normalizeStyle as C,toDisplayString as H,renderSlot as j,pushScopeId as T,popScopeId as E}from"vue";import{flattenObjectArray as I}from"./tools/utils.js";import{elnamespace as L}from"./hooks/configElement.js";import M from"element-plus/dist/locale/zh-cn.mjs";import{s as S}from"./style-inject.es-BnTDb6vU.js";const U=(e=>(T("data-v-54144062"),e=e(),E(),e))((()=>b("i",{class:"custom custom-journey-search"},null,-1))),K=["data-key"],N={key:0,class:"label-info"},V={key:1,class:"custom custom-shujiegou-wuziji statusicon"},z=["innerHTML"],D=["innerHTML"],$={key:4},P={key:1,class:"label-info"},R=["innerHTML"],B=["innerHTML"];var q={__name:"index",props:{data:{default:()=>[]},showSearch:{default:""},showCheckbox:{default:!1},noDisabled:{default:!1},showCount:{default:!1},currentChecked:{default:()=>[]},currentClickKeys:{default:""},wrapHeight:{default:"200"},defaultExpandedKeys:{default:()=>[]},inputPlaceHolder:{default:"请输入部门/成员名称"}},emits:["nodeClick","checkChange"],setup(T,{expose:E,emit:S}){const q=T,F=S,{currentChecked:A,currentClickKeys:G,wrapHeight:J,defaultExpandedKeys:O}=r(q);q.data[0]&&O.value.push(q.data[0].deptUserId);const Q=s((()=>I(q.data,"list"))),W=i(),X=i("");c(X,(e=>{W.value&&W.value.filter(e)}));const Y=(e,n,t)=>!e||("select"==q.showSearch?n.id==e:"input"==q.showSearch?n.asearchName.includes(e):void 0);function Z(e,n,t,a){!q.noDisabled&&e.disabled?(n.isCurrent=!1,W.value.setCurrentKey(),F("nodeClick",{data:{},node:{},treenode:{},event:{}})):F("nodeClick",{data:e,node:n,treenode:t,event:a})}function ee(e,n,t){F("checkChange",{data:e,check:n,childCheck:t})}function ne(e){O.value.push(e.deptUserId)}function te(e){const n=O.value.findIndex((n=>n===e.deptUserId));O.value.splice(n,1)}function ae(){if(G.value){const e=Q.value.find((e=>e.id==G.value));W.value.setCurrentKey(e.deptUserId)}}function le(e){if(X.value){const n=new RegExp(X.value,"g");return e.replace(n,`<span class='hightName'>${X.value}</span>`)}return e}return u((()=>{!function(){if(A.value){let e=[];A.value.forEach((n=>{const t=Q.value.filter((e=>e.id==n));t&&e.push(...t)})),e=e.map((e=>e.deptUserId)),W.value.setCheckedKeys(e)}}(),ae()})),h((()=>{p((()=>{ae()}))})),E({treeRef:W}),(r,s)=>{const i=e,c=n,u=t,h=a,p=l,T=o,E=d;return f(),m(E,{namespace:v(L),locale:v(M)},{default:x((()=>[q.showSearch&&"select"==q.showSearch?(f(),m(c,{key:0,class:"filter_commpoent",modelValue:X.value,"onUpdate:modelValue":s[0]||(s[0]=e=>X.value=e),placeholder:"请选择"},{default:x((()=>[g(i,{label:"请选择",value:""}),(f(!0),k(y,null,_(Q.value,(e=>(f(),m(i,{label:e.name,key:e.id,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):w("v-if",!0),q.showSearch&&"input"==q.showSearch?(f(),m(h,{key:1,class:"filter_commpoent",modelValue:X.value,"onUpdate:modelValue":s[1]||(s[1]=e=>X.value=e),placeholder:q.inputPlaceHolder},{suffix:x((()=>[g(u,{class:"el-input__icon"},{default:x((()=>[U])),_:1})])),_:1},8,["modelValue","placeholder"])):w("v-if",!0),b("section",{class:"tree_wrap","data-key":v(J),style:C({height:/^\d+$/.test(v(J))?`${v(J)}px`:v(J),overflow:"auto"})},[g(T,{data:q.data,ref_key:"treeRef",ref:W,"node-key":"deptUserId","render-after-expand":!1,"show-checkbox":q.showCheckbox,onCheckChange:ee,"check-strictly":!1,props:{children:"list"},"expand-on-click-node":!1,"highlight-current":!0,"default-expanded-keys":v(O),"filter-node-method":Y,onNodeClick:Z,onNodeExpand:ne,onNodeCollapse:te},{default:x((({node:e,data:n})=>[b("div",{class:"custom-tree-node",style:C({cursor:!q.noDisabled&&n.disabled?"not-allowed":"inherit"})},[0==n.infoType?(f(),k("div",N,[w(" // infotype = 0 就是部门 "),n.list.length?(f(),k("img",{key:0,class:"statusicon",src:"https://qa-crm.leadscloud.com/Front-PermissionSystem/image/fileicon.svg",width:"15"})):(f(),k("i",V)),n.name.replace(/[^\x00-\xff]/gi,"--").length>16?(f(),m(p,{key:2,content:n.name,placement:"bottom","show-after":500,"hide-after":0},{default:x((()=>[b("span",{class:"tree-title",innerHTML:le(n.name)},null,8,z)])),_:2},1032,["content"])):(f(),k("span",{key:3,class:"tree-title",style:{"padding-right":"12px"},innerHTML:le(n.name)},null,8,D)),w(" 是否显示数量 "),q.showCount?(f(),k("span",$,"("+H(n.count)+")",1)):w("v-if",!0)])):w("v-if",!0),1==n.infoType?(f(),k("div",P,[w(" // infotype = 1 就是用户 "),n.name.replace(/[^\x00-\xff]/gi,"--").length>16?(f(),m(p,{key:0,content:n.name,placement:"bottom","show-after":500,"hide-after":0},{default:x((()=>[b("span",{class:"tree-title",innerHTML:le(n.name)},null,8,R)])),_:2},1032,["content"])):(f(),k("span",{key:1,class:"tree-title",style:{"padding-right":"12px"},innerHTML:le(n.name)},null,8,B))])):w("v-if",!0),w(" 操作按钮区域插槽 "),j(r.$slots,"default",{params:{data:n,node:e}})],4)])),_:3},8,["data","show-checkbox","default-expanded-keys"])],12,K)])),_:3},8,["namespace","locale"])}}};S(".custom-tree-node[data-v-54144062] {\n  display: flex;\n  height: 30px;\n  width: 100%;\n  margin-left: 8px;\n  justify-content: space-between;\n  font-size: 14px;\n  align-items: center;\n  color: #303133;\n}\n.custom-tree-node .label-info[data-v-54144062] {\n  display: flex;\n  align-items: center;\n}\n.custom-tree-node .label-info .custom-shujiegou-wuziji[data-v-54144062] {\n  color: #909399;\n}\n.custom-tree-node .tree-title[data-v-54144062] {\n  display: inline-block;\n  max-width: 120px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.custom-tree-node .tree-title[data-v-54144062] .hightName {\n  background: #fff6a0;\n}\n.custom-tree-node .statusicon[data-v-54144062] {\n  margin-right: 10px;\n}\n.custom-tree-node:hover .label-info[data-v-54144062] {\n  color: #3B78DE;\n}\n.filter_commpoent[data-v-54144062] {\n  width: 100%;\n  margin-bottom: 10px;\n  padding-right: 30px;\n  box-sizing: border-box;\n}\n[data-v-54144062] .xhl-el-tree-node__content .xhl-el-tree-node__expand-icon {\n  padding: 0;\n}\n[data-v-54144062] .xhl-el-tree-node__content .xhl-el-checkbox {\n  margin-left: 4px;\n  margin-right: 0;\n}\n[data-v-54144062] .xhl-el-tree-node__content:hover {\n  background-color: transparent;\n}\n[data-v-54144062] .xhl-el-tree-node:focus > .xhl-el-tree-node__content {\n  background-color: transparent;\n}\n[data-v-54144062] .xhl-el-tree--highlight-current .xhl-el-tree-node.is-current > .xhl-el-tree-node__content {\n  background-color: #f5f7fa !important;\n}\n[data-v-54144062] .xhl-el-tree--highlight-current .xhl-el-tree-node.is-current > .xhl-el-tree-node__content .tree-title {\n  color: #3B78DE;\n}\n[data-v-54144062] .xhl-el-tree-node > .xhl-el-tree-node__children {\n  overflow: visible;\n}"),q.__scopeId="data-v-54144062",q.__file="src/components/customtree/index.vue";export{q as s};
